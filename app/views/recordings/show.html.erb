<h1><%= @recording.title %></h1>

<p><strong>Game:</strong> <%= @recording.game_name.presence || "N/A" %></p>
<p><strong>Players:</strong> <%= @recording.players.presence || "N/A" %></p>
<p><strong>Date Played:</strong> <%= @recording.date_played ? @recording.date_played.strftime("%B %d, %Y") : "N/A" %></p>

<hr>

<% if @recording.show_processing_section? %>
  <h2>Processing Status</h2>
  <p class="<%= @recording.transcript.nil? ? 'status-waiting' : 'status-ready' %>">
    <em><%= @recording.processing_message %></em>
  </p>
  <hr>
<% end %>

<h2>Full Recording</h2>
<% if @recording.video.attached? %>
  <%= video_tag @recording.video, controls: true, width: 640 %>
<% else %>
  <p>No video attached for this recording.</p>
<% end %>

<hr>

<section class="clips-section">
  <h2>üéÆ Highlight Reel</h2>
  <% if @clips.any? %>
    <div class="clips-theater">
      <% @clips.each_with_index do |clip, index| %>
        <details class="clip-wrapper" <%= "open" if index == 0 %>>
          <summary class="clip-header">
            <span class="clip-number">#<%= index + 1 %></span>
            <span class="clip-name"><%= clip.title %></span>
            <span class="clip-duration">
              <%= "#{(clip.end_time - clip.start_time).round}s" %>
            </span>
          </summary>
          <% if clip.video.attached? %>
            <%= video_tag clip.video, controls: true, class: "clip-player" %>
          <% else %>
            <div class="video-error">‚ö†Ô∏è Video processing...</div>
          <% end %>
        </details>
      <% end %>
    </div>
  <% else %>
    <div class="empty-state">
      <p>üé¨ No clips yet!</p>
      <p>Use ClipGenerationService to create highlights</p>
    </div>
  <% end %>
</section>